import{c as d}from"./server-fns-runtime-HUGH5Jm0.js";import"solid-js/web";import"solid-js/web/storage";import"./fetchEvent-CIpVWTXg.js";import"h3";import"unctx";import"node:async_hooks";const E=d(async e=>{const{db:i}=await import("./index-BinUX9hy.js"),{users:n}=await import("./schema-DxiP6MVG.js").then(s=>s.a),{eq:a}=await import("drizzle-orm"),c=await import("bcryptjs"),{getEvent:m,setCookie:u}=await import("./fetchEvent-CIpVWTXg.js").then(s=>s.h),r=String(e.get("username")),p=String(e.get("password"));console.log(`Attempting login for: ${r}`);const o=await i.query.users.findFirst({where:a(n.username,r)});if(!o)throw console.log("User not found"),new Error("Invalid username or password");const t=await c.compare(p,o.password);if(console.log(`Password valid: ${t}`),!t)throw console.log("Invalid password"),new Error("Invalid username or password");const{createUserSession:l}=await import("./session-D_Gl5yQj.js");return console.log("Creating session..."),await l(o.id),console.log("[Login] Session created. Returning success for client-side redirect."),{success:!0}},"src_routes_auth_login_tsx--login_action","/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/auth/login.tsx?pick=default&pick=%24css&tsr-directive-use-server=");export{E as login_action};
