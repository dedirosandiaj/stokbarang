import{parseSetCookie as W}from"cookie-es";import{fromJSON as O,crossSerializeStream as z,getCrossReferenceHeader as G}from"seroval";import{CustomEventPlugin as k,DOMExceptionPlugin as R,EventPlugin as $,FormDataPlugin as P,HeadersPlugin as x,ReadableStreamPlugin as y,RequestPlugin as w,ResponsePlugin as S,URLSearchParamsPlugin as U,URLPlugin as E}from"seroval-plugins/web";import{lazy as K,createComponent as V,sharedConfig as H}from"solid-js";import{ssrElement as f,escape as Q,mergeProps as Y,ssr as Z,isServer as ee,getRequestEvent as te,renderToString as re}from"solid-js/web";import{provideRequestEvent as L}from"solid-js/web/storage";import{g as se,s as oe,a as ae,m as N,b as D,c as g,d as ne,p as ie}from"./fetchEvent-CIpVWTXg.js";import{eventHandler as ce}from"h3";import"node:async_hooks";import{createRouter as de}from"radix3";const b="Invariant Violation",{setPrototypeOf:ue=function(e,r){return e.__proto__=r,e}}=Object;class v extends Error{framesToPop=1;name=b;constructor(r=b){super(typeof r=="number"?`${b}: ${r} (see https://github.com/apollographql/invariant-packages)`:r),ue(this,v.prototype)}}function pe(e,r){if(!e)throw new v(r)}const I=[{page:!0,$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("../_...404_.js"),import:()=>import("../_...404_.js")},path:"/*404",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/[...404].tsx"},{page:!0,$component:{src:"src/routes/about.tsx?pick=default&pick=$css",build:()=>import("../about.js"),import:()=>import("../about.js")},path:"/about",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/about.tsx"},{page:!0,$component:{src:"src/routes/auth/login.tsx?pick=default&pick=$css",build:()=>import("../login.js"),import:()=>import("../login.js")},path:"/auth/login",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/auth/login.tsx"},{page:!0,$component:{src:"src/routes/dashboard/bad-stock.tsx?pick=default&pick=$css",build:()=>import("../bad-stock.js"),import:()=>import("../bad-stock.js")},path:"/dashboard/bad-stock",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/bad-stock.tsx"},{page:!0,$component:{src:"src/routes/dashboard/barang-keluar.tsx?pick=default&pick=$css",build:()=>import("../barang-keluar.js"),import:()=>import("../barang-keluar.js")},path:"/dashboard/barang-keluar",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/barang-keluar.tsx"},{page:!0,$component:{src:"src/routes/dashboard/barang-masuk.tsx?pick=default&pick=$css",build:()=>import("../barang-masuk.js"),import:()=>import("../barang-masuk.js")},path:"/dashboard/barang-masuk",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/barang-masuk.tsx"},{page:!0,$component:{src:"src/routes/dashboard/index.tsx?pick=default&pick=$css",build:()=>import("../index.js"),import:()=>import("../index.js")},path:"/dashboard/",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/index.tsx"},{page:!0,$component:{src:"src/routes/dashboard/main.tsx?pick=default&pick=$css",build:()=>import("../main.js"),import:()=>import("../main.js")},path:"/dashboard/main",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/main.tsx"},{page:!0,$component:{src:"src/routes/dashboard/produk/[id]/edit.tsx?pick=default&pick=$css",build:()=>import("../edit.js"),import:()=>import("../edit.js")},path:"/dashboard/produk/:id/edit",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/produk/[id]/edit.tsx"},{page:!0,$component:{src:"src/routes/dashboard/produk/create.tsx?pick=default&pick=$css",build:()=>import("../create.js"),import:()=>import("../create.js")},path:"/dashboard/produk/create",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/produk/create.tsx"},{page:!0,$component:{src:"src/routes/dashboard/produk/index.tsx?pick=default&pick=$css",build:()=>import("../index2.js"),import:()=>import("../index2.js")},path:"/dashboard/produk/",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/produk/index.tsx"},{page:!0,$component:{src:"src/routes/dashboard/settings.tsx?pick=default&pick=$css",build:()=>import("../settings.js"),import:()=>import("../settings.js")},path:"/dashboard/settings",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/settings.tsx"},{page:!0,$component:{src:"src/routes/dashboard/users/[id].tsx?pick=default&pick=$css",build:()=>import("../_id_.js"),import:()=>import("../_id_.js")},path:"/dashboard/users/:id",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/users/[id].tsx"},{page:!0,$component:{src:"src/routes/dashboard/users/create.tsx?pick=default&pick=$css",build:()=>import("../create2.js"),import:()=>import("../create2.js")},path:"/dashboard/users/create",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/users/create.tsx"},{page:!0,$component:{src:"src/routes/dashboard/users/index.tsx?pick=default&pick=$css",build:()=>import("../index3.js"),import:()=>import("../index3.js")},path:"/dashboard/users/",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard/users/index.tsx"},{page:!0,$component:{src:"src/routes/dashboard.tsx?pick=default&pick=$css",build:()=>import("../dashboard.js"),import:()=>import("../dashboard.js")},path:"/dashboard",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/dashboard.tsx"},{page:!0,$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("../index4.js"),import:()=>import("../index4.js")},path:"/",filePath:"/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/index.tsx"}],le=me(I.filter(e=>e.page));function me(e){function r(t,a,o,n){const i=Object.values(t).find(c=>o.startsWith(c.id+"/"));return i?(r(i.children||(i.children=[]),a,o.slice(i.id.length)),t):(t.push({...a,id:o,path:o.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/")}),t)}return e.sort((t,a)=>t.path.length-a.path.length).reduce((t,a)=>r(t,a,a.path,a.path),[])}function he(e){return e.$HEAD||e.$GET||e.$POST||e.$PUT||e.$PATCH||e.$DELETE}de({routes:I.reduce((e,r)=>{if(!he(r))return e;let t=r.path.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/").replace(/\*([^/]*)/g,(a,o)=>`**:${o}`).split("/").map(a=>a.startsWith(":")||a.startsWith("*")?a:encodeURIComponent(a)).join("/");if(/:[^/]*\?/g.test(t))throw new Error(`Optional parameters are not supported in API routes: ${t}`);if(e[t])throw new Error(`Duplicate API routes for "${t}" found at "${e[t].route.path}" and "${r.path}"`);return e[t]={route:r},e},{})});function fe(e){e.forEach(r=>{if(!r.attrs.href)return;let t=document.head.querySelector(`link[href="${r.attrs.href}"]`);t||(t=document.createElement("link"),t.setAttribute("rel","preload"),t.setAttribute("as","style"),t.setAttribute("href",r.attrs.href),document.head.appendChild(t))})}var ge=" ";const be={style:e=>f("style",e.attrs,()=>e.children,!0),link:e=>f("link",e.attrs,void 0,!0),script:e=>e.attrs.src?f("script",Y(()=>e.attrs,{get id(){return e.key}}),()=>Z(ge),!0):null,noscript:e=>f("noscript",e.attrs,()=>Q(e.children),!0)};function _e(e,r){let{tag:t,attrs:{key:a,...o}={key:void 0},children:n}=e;return be[t]({attrs:{...o,nonce:r},key:a,children:n})}function ke(e,r,t,a="default"){return K(async()=>{{const n=(await e.import())[a],c=(await r.inputs?.[e.src].assets()).filter(u=>u.tag==="style"||u.attrs.rel==="stylesheet");return typeof window<"u"&&fe(c),{default:u=>[...c.map(m=>_e(m)),V(n,u)]}}})}function M(){function e(t){return{...t,...t.$$route?t.$$route.require().route:void 0,info:{...t.$$route?t.$$route.require().route.info:{},filesystem:!0},component:t.$component&&ke(t.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:t.children?t.children.map(e):void 0}}return le.map(e)}let q;const Ae=ee?()=>te().routes:()=>q||(q=M());function Re(e){const r=se(e.nativeEvent,"flash");if(r)try{let t=JSON.parse(r);if(!t||!t.result)return;const a=[...t.input.slice(0,-1),new Map(t.input[t.input.length-1])],o=t.error?new Error(t.result):t.result;return{input:a,url:t.url,pending:!1,result:t.thrown?void 0:o,error:t.thrown?o:void 0}}catch(t){console.error(t)}finally{oe(e.nativeEvent,"flash","",{maxAge:0})}}async function $e(e){const r=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,e.response.headers.set("Content-Type","text/html"),Object.assign(e,{manifest:await r.json(),assets:[...await r.inputs[r.handler].assets()],router:{submission:Re(e)},routes:M(),complete:!1,$islands:new Set})}const Pe=new Set([301,302,303,307,308]);function xe(e){return e.status&&Pe.has(e.status)?e.status:302}const ye={"src_routes_auth_login_tsx--login_action":{functionName:"login_action",importer:()=>import("./login-CGNBHsLW.js")},"src_routes_dashboard_index_tsx--getAuthenticatedUser_1":{functionName:"getAuthenticatedUser_1",importer:()=>import("./index-D39yfOTr.js")},"src_routes_dashboard_tsx--protectRoute_1":{functionName:"protectRoute_1",importer:()=>import("./dashboard-D5mZp-20.js")},"src_lib_auth-checks_ts--checkSession_1":{functionName:"checkSession_1",importer:()=>import("./auth-checks-BwLvXVBd.js")},"src_lib_users_ts--getUsers_1":{functionName:"getUsers_1",importer:()=>import("./users-DUDoXUFs.js")},"src_lib_users_ts--getUser_1":{functionName:"getUser_1",importer:()=>import("./users-DUDoXUFs.js")},"src_lib_users_ts--createUser_1":{functionName:"createUser_1",importer:()=>import("./users-DUDoXUFs.js")},"src_lib_users_ts--updateUser_1":{functionName:"updateUser_1",importer:()=>import("./users-DUDoXUFs.js")},"src_lib_users_ts--deleteUser_1":{functionName:"deleteUser_1",importer:()=>import("./users-DUDoXUFs.js")},"src_lib_products_ts--getProducts_1":{functionName:"getProducts_1",importer:()=>import("./products-QOPIUUBV.js")},"src_lib_products_ts--getProduct_1":{functionName:"getProduct_1",importer:()=>import("./products-QOPIUUBV.js")},"src_lib_products_ts--createProduct_1":{functionName:"createProduct_1",importer:()=>import("./products-QOPIUUBV.js")},"src_lib_products_ts--updateProduct_1":{functionName:"updateProduct_1",importer:()=>import("./products-QOPIUUBV.js")},"src_lib_products_ts--deleteProduct_1":{functionName:"deleteProduct_1",importer:()=>import("./products-QOPIUUBV.js")},"src_lib_session_ts--getUser_1":{functionName:"getUser_1",importer:()=>import("./session-C4pX75Tv.js")},"src_lib_session_ts--createUserSession_1":{functionName:"createUserSession_1",importer:()=>import("./session-C4pX75Tv.js")},"src_lib_session_ts--logout_1":{functionName:"logout_1",importer:()=>import("./session-C4pX75Tv.js")}};function we(e){const r=new TextEncoder().encode(e),t=r.length,a=t.toString(16),o="00000000".substring(0,8-a.length)+a,n=new TextEncoder().encode(`;0x${o};`),i=new Uint8Array(12+t);return i.set(n),i.set(r,12),i}function J(e,r){return new ReadableStream({start(t){z(r,{scopeId:e,plugins:[k,R,$,P,x,y,w,S,U,E],onSerialize(a,o){t.enqueue(we(o?`(${G(e)},${a})`:a))},onDone(){t.close()},onError(a){t.error(a)}})}})}async function Se(e){const r=ae(e),t=r.request,a=t.headers.get("X-Server-Id"),o=t.headers.get("X-Server-Instance"),n=t.headers.has("X-Single-Flight"),i=new URL(t.url);let c,p;if(a)pe(typeof a=="string","Invalid server function"),[c,p]=a.split("#");else if(c=i.searchParams.get("id"),p=i.searchParams.get("name"),!c||!p)return new Response(null,{status:404});const u=ye[c];let m;if(!u)return new Response(null,{status:404});m=await u.importer();const j=m[u.functionName];let l=[];if(!o||e.method==="GET"){const s=i.searchParams.get("args");if(s){const d=JSON.parse(s);(d.t?O(d,{plugins:[k,R,$,P,x,y,w,S,U,E]}):d).forEach(h=>l.push(h))}}if(e.method==="POST"){const s=t.headers.get("content-type"),d=e.node.req,h=d instanceof ReadableStream,B=d.body instanceof ReadableStream,T=h&&d.locked||B&&d.body.locked,C=h?d:d.body;if(s?.startsWith("multipart/form-data")||s?.startsWith("application/x-www-form-urlencoded"))l.push(await(T?t:new Request(t,{...t,body:C})).formData());else if(s?.startsWith("application/json")){const X=T?t:new Request(t,{...t,body:C});l=O(await X.json(),{plugins:[k,R,$,P,x,y,w,S,U,E]})}}try{let s=await L(r,async()=>(H.context={event:r},r.locals.serverFunctionMeta={id:c+"#"+p},j(...l)));if(n&&o&&(s=await A(r,s)),s instanceof Response){if(s.headers&&s.headers.has("X-Content-Raw"))return s;o&&(s.headers&&N(e,s.headers),s.status&&(s.status<300||s.status>=400)&&D(e,s.status),s.customBody?s=await s.customBody():s.body==null&&(s=null))}return o?(g(e,"content-type","text/javascript"),J(o,s)):F(s,t,l)}catch(s){if(s instanceof Response)n&&o&&(s=await A(r,s)),s.headers&&N(e,s.headers),s.status&&(!o||s.status<300||s.status>=400)&&D(e,s.status),s.customBody?s=s.customBody():s.body==null&&(s=null),g(e,"X-Error","true");else if(o){const d=s instanceof Error?s.message:typeof s=="string"?s:"true";g(e,"X-Error",d.replace(/[\r\n]+/g,""))}else s=F(s,t,l,!0);return o?(g(e,"content-type","text/javascript"),J(o,s)):s}}function F(e,r,t,a){const o=new URL(r.url),n=e instanceof Error;let i=302,c;return e instanceof Response?(c=new Headers(e.headers),e.headers.has("Location")&&(c.set("Location",new URL(e.headers.get("Location"),o.origin+"").toString()),i=xe(e))):c=new Headers({Location:new URL(r.headers.get("referer")).toString()}),e&&c.append("Set-Cookie",`flash=${encodeURIComponent(JSON.stringify({url:o.pathname+o.search,result:n?e.message:e,thrown:a,error:n,input:[...t.slice(0,-1),[...t[t.length-1].entries()]]}))}; Secure; HttpOnly;`),new Response(null,{status:i,headers:c})}let _;function Ue(e){const r=new Headers(e.request.headers),t=ie(e.nativeEvent),a=e.response.headers.getSetCookie();r.delete("cookie");let o=!1;return e.nativeEvent.node?.req&&(o=!0,e.nativeEvent.node.req.headers.cookie=""),a.forEach(n=>{if(!n)return;const{maxAge:i,expires:c,name:p,value:u}=W(n);if(i!=null&&i<=0){delete t[p];return}if(c!=null&&c.getTime()<=Date.now()){delete t[p];return}t[p]=u}),Object.entries(t).forEach(([n,i])=>{r.append("cookie",`${n}=${i}`),o&&(e.nativeEvent.node.req.headers.cookie+=`${n}=${i};`)}),r}async function A(e,r){let t,a=new URL(e.request.headers.get("referer")).toString();r instanceof Response&&(r.headers.has("X-Revalidate")&&(t=r.headers.get("X-Revalidate").split(",")),r.headers.has("Location")&&(a=new URL(r.headers.get("Location"),new URL(e.request.url).origin+"").toString()));const o=ne(e);return o.request=new Request(a,{headers:Ue(e)}),await L(o,async()=>{await $e(o),_||(_=(await import("./app-C76_G7l3.js")).default),o.router.dataOnly=t||!0,o.router.previousUrl=e.request.headers.get("referer");try{re(()=>{H.context.event=o,_()})}catch(c){console.log(c)}const n=o.router.data;if(!n)return r;let i=!1;for(const c in n)n[c]===void 0?delete n[c]:i=!0;return i&&(r instanceof Response?r.customBody&&(n._$value=r.customBody()):(n._$value=r,r=new Response(null,{status:200})),r.customBody=()=>n,r.headers.set("X-Single-Flight","true")),r})}const He=ce(Se);export{Ae as F,He as h};
