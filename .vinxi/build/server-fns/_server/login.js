import{ssr as i,ssrHydrationKey as a,escape as t,createComponent as w,ssrAttribute as l}from"solid-js/web";import{c as b}from"./assets/server-fns-runtime-HUGH5Jm0.js";import{createEffect as h}from"solid-js";import{L as v}from"./assets/Loading-b-bAnbUN.js";import{u as x,a as y}from"./assets/action-CnXm9LBs.js";import"solid-js/web/storage";import"./assets/fetchEvent-CIpVWTXg.js";import"h3";import"unctx";import"node:async_hooks";import"./assets/routing-CMRlbYJP.js";var S=["<div",' class="flex items-center justify-center min-h-screen bg-gray-100"><!--$-->','<!--/--><div class="p-8 bg-white rounded shadow-md w-96 relative"><h1 class="mb-6 text-2xl font-bold text-center">Login</h1><form',' method="post" class="flex flex-col gap-4"><div><label class="block mb-2 text-sm font-bold text-gray-700">Username</label><input type="text" name="username" class="w-full px-3 py-2 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" required></div><div><label class="block mb-2 text-sm font-bold text-gray-700">Password</label><input type="password" name="password" class="w-full px-3 py-2 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" required></div><!--$-->','<!--/--><button type="submit"',' class="','">',"</button></form></div></div>"],_=["<div",' class="text-red-500 text-sm font-bold text-center">',"</div>"];const $=b(async e=>{const{db:d}=await import("./assets/index-BinUX9hy.js"),{users:u}=await import("./assets/schema-DxiP6MVG.js").then(s=>s.a),{eq:p}=await import("drizzle-orm"),m=await import("bcryptjs"),{getEvent:L,setCookie:k}=await import("./assets/fetchEvent-CIpVWTXg.js").then(s=>s.h),r=String(e.get("username")),g=String(e.get("password"));console.log(`Attempting login for: ${r}`);const o=await d.query.users.findFirst({where:p(u.username,r)});if(!o)throw console.log("User not found"),new Error("Invalid username or password");const n=await m.compare(g,o.password);if(console.log(`Password valid: ${n}`),!n)throw console.log("Invalid password"),new Error("Invalid username or password");const{createUserSession:f}=await import("./assets/session-D_Gl5yQj.js");return console.log("Creating session..."),await f(o.id),console.log("[Login] Session created. Returning success for client-side redirect."),{success:!0}},"src_routes_auth_login_tsx--login_action","/Users/dedirosandi/Documents/PROJECT/program-ela/src/routes/auth/login.tsx?pick=default&pick=%24css&tsr-directive-use-server="),c=y($);function J(){const e=x(c);return h(()=>{e.result?.success&&(console.log("Login successful, performing full page navigation..."),window.location.href="/dashboard")}),i(S,a(),e.pending&&t(w(v,{})),l("action",t(c,!0),!1),e.error&&i(_,a(),t(e.error.message)),l("disabled",e.pending,!0),`px-4 py-2 font-bold text-white rounded focus:outline-none focus:shadow-outline ${e.pending?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700"}`,e.pending?"Signing In...":"Sign In")}export{J as default};
